---
aliases:
tags:
  - 操作系统
  - 计算机组成原理
date created: 2023-10-15 日 07:14:36
date modified: 2023-10-15 日 09:23:29
---

# Link

---

Previous: [6.1_输入输出](6.1_输入输出.md)

Next:

# 输入输出方式

---

## 程序直接控制

也称程序查询方式。

## 中断驱动方式

### 流程

#### 发出中断请求

设备通过 INTR 线或 NMI 线发出中断请求。在关中断的情况下，通过 INTR 线发出的中断请求不会被响应。

#### 系统判断中断优先级

$$
\begin{align}
& 不可屏蔽>异常>可屏蔽中断 \\
& 异常:硬件故障>软件中断 \\
& DMA>I/O设备 \\
& 高速设备>低速设备、输入>输出、实时>普通 \\
\end{align}
$$

#### 响应中断过程

##### 硬件过程

通过硬件执行一系列操作，称为中断隐指令。

- 关中断
- 保存断点
- 引出中断服务程序

##### 中断服务过程

- 保存现场（GPRs、PSW 等）和*屏蔽字*
- *开中断*
- *响应优先级更高的中断*
- *关中断*
- 执行中断服务程序
- 恢复现场（GPRs、PSW 等）和屏蔽字
- 开中断
- 中断返回

#### 多级中断

在中断服务中开中断以便于响应多级中断。

##### 屏蔽字

## DMA 方式

### DMA 控制器与 CPU 使用主存的方式

- CPU 在 DMA 传送的过程停止访存
- CPU 和 I/O 设备访存冲突时，I/O 设备优先访存
- DMA 和 CPU 交替访存

### DMA 传送过程

#### 预处理

开始传送数据前，由 CPU 完成一些必要工作：

- 初始化 DMA 控制器中寄存器
- 设置传送方向
- 启动设备

#### 数据传送

由 DMA 完全控制数据传送阶段。

#### 后处理

结束传送数据后，向 CPU 发送中断请求。

CPU 做如下工作：

- 校验数据
- 测试是否出错
- 是否继续通过 DMA 传送数据

## 中断方式与 DMA 方式的比较

|              | 中断             | DMA                |
| ------------ | ---------------- | ------------------ |
| 请求         | CPU 处理时间     | 总线使用权         |
| 响应         | 一条指令结束后   | 一个总线事务完成后 |
| 数据传送方式 | 软件             | 硬件               |
| 适用         | 不适用于高速设备 | 所有设备           |

# Relative

---

[6.1_输入输出](6.1_输入输出.md)

# Reference

---
