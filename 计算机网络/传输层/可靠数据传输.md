---
aliases:
tags:
  - 计算机网络
date created: 2023-09-19 二 04:07:45
date modified: 2023-09-19 二 04:13:23
---

# Link

---

Previous:

Next:

# 可靠数据传输

---

## 快速重传

- 冗余 ACK

  当接收方收到一个大于期望序号（确认号）的报文段时，说明中间有报文段丢失，需要重发丢失的报文段。此时，接收方就对最后一个按序接收的字节数据进行重复确认，因此产生了冗余 ACK。

- 快速重传

  连续收到 3 个对相同数据的冗余 ACK，TCP 认为该报文段及之后的报文段均丢失，执行快速重传。即重传丢失的报文段。

## 回退 N 步

有如下定义：

基序号 (base)：最早未确认分组的序号。

下一个序号 (nextseqnum)：最小的未使用序号。

N：发送窗口大小，分组序号字段大小为 k bit，则 N = $2^k-1$。

将序号范围划分为四段：

- [0, base - 1]：已经确认的分组
- [base, nextseqnum - 1]：已发送，还未确认的分组
- [nextseqnum, base + N - 1]：还未发送，可以发送的分组
- [base + N, -]：不能使用的分组序号

- GBN 使用**累积确认**；超时发生时，发送方重发所有已发送还未确认的分组；发送方接受 ACK 时，发送窗口前进。

## 选择重传

有如下定义：

send_base：最小已发送未确认的序号，发送窗口的基序号。

rvc_base：接收窗口的基序号。

N：发送窗口大小，分组序号字段大小为 k bit，则 N= $2^{k-1}$。

- SR 仅重传那些它怀疑在接收方出错的分组。

- 发送方：
  - 从上层收到数据
    SR 检查数据的序号，序号在发送窗口内，发送分组；否则选择缓存或者返回给上层。
  - 超时
    每个分组有单独的定时器，超时发生时发送超时的分组。
  - 收到 ACK
    受到 ACK 的分组的序号等于 send_base 时，更新 send_base，将发送窗口移动到 send_base。
- 接收方
  - 序号在[rcv_base, rcv_base + N -1]内的分组正确接收。
    返回一个 ACK。分组没有被接收过：缓存该分组；分组等于 rcv_base 时，更新 rvc_base，将该分组和以前缓存序号连续的分组一同交付给上层。
  - 序号在[rcv_base - N, rcv_base - 1]内的分组正确接收。
    产生一个 ACK，这是接收方已经确认过的分组。
  - 其他，忽略

# Relative

---

[TCP](TCP.md)

# Reference

---
