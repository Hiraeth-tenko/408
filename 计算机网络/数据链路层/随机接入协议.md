---
aliases: 
tags:
  - 计算机网络
date created: 2023-09-22 五 05:19:37
date modified: 2023-10-27 五 01:20:07
---

# Link

---

Previous: [数据链路层](数据链路层.md)

Next: [局域网](局域网.md)

# 随机接入协议

---

## ALOHA

## 时隙 ALOHA

## CSMA

CSMA 在 ALOHA 协议上增加了载波监听的规则。

### 载波侦听

一个站点要传输前先侦听一下信道，如果有其他站点正在传输，该站点就停止发送。重复【侦听-当空闲时传输】的循环之前，会间隔一段等待时间。

## CSMA/CD

CSMA/CD 在 CSMA 的基础上，增加了**碰撞检测**与**二进制指数后退**的规则。

### 碰撞检测

通过传输一个无用的短帧来进行碰撞检测。

设两个站点 $A、B$ 使用一条信道互相发送信息，端到端传播时间（**单向传播延时**）为 $\tau$，则站点 $A$ 在发送检测帧后最多经过 $2\tau$ 就可以知道是否发生了碰撞。

由于传播速度的限制，信道被检测为空闲时，不一定是空闲的。因此以太网规定了争用期和最短帧长两个概念。争用期即上述 $2\tau$ 的时间；最短帧长为争用期可以发送的最小数据长度，小于最短帧长的帧都被认为是由于**冲突导致异常终止的无效帧**。因此要发送帧长小于最短帧长的帧时，需要对帧进行填充（即填充字段），使其帧长不小于最短帧长。以太网规定最短帧长为 $64B$。

$最短帧长=单向传播延时\times 数据传输速率\times 2$

### 二进制指数后退

要解决碰撞问题，提出了一种叫截断二进制指数退避的算法。

算法定义了一个参数 $k=\min\{重传次数,10\}$。$k$ 初始为 $1$，每次需要重传时，$k$ 就加一，直到 $k$ 增长到 $10$ 为止。从 $\{1,2,\cdot\cdot\cdot,2^k-1\}$ 中选出一个数 $r$，重传时间= $r\times 基本退避时间$，其中基本退避时间= $2\tau$（一般选用争用期的时间长度）。当重传 16 次仍不能成功，认为无法发出该帧，抛弃该帧并向上层报告。

### 工作流程

1. 侦听信道，如果空闲则开始传输帧；否则等待直到信道空闲后开始传输帧。
2. 传输帧的同时继续侦听信道，如果检测到碰撞立刻停止传输帧。
3. 在争用期内没有检测到碰撞，则该帧将被正确发出；检测到碰撞，则停止传输帧，并执行二进制指数后退算法。当重传 16 次仍不能成功，认为无法发出该帧，抛弃该帧并向上层报告。

## CSMA/CA

CSMA/CA 主要用于无线局域网环境。在 CSMA 的基础上实现了**碰撞避免**与**确认功能**

### 链路层确认

站点在接收一个通过 CRC 校验的帧后，经过一段称为 SIFS（短帧间间隔）的短时间后，向来源站点发送一个确认帧。在规定时间内没有收到确认帧就认为该帧出错并重发该帧，数次重发后放弃发送并丢弃该帧。

每次接收到一个帧都需要等待 SIFS。

### 碰撞避免

CSMA/CA 采用碰撞避免而不是碰撞检测（处于实际情况考量）。

DIFS 的长度大于 SIFS。

### 工作流程

1. 侦听信道，如果信道空闲，那么等待一段称为 DIFS（分布式帧间间隔）后发送该帧。
2. 否则执行二进制退避算法，选取一个回退值。回退值在侦听到信道空闲时减小，信道忙时不变。
3. 当回退值为 0 时，此时信道必然是空闲的，站点将整个数据帧发送并等待确认。
4. 如果收到确认，发送站点就得知他的帧被目的站点正确接收。如果要继续发送下一帧，则回到第二步；如果需要重发（未收到确认帧），则进入第二步的回退阶段，在更大的范围内选取随机值。

### 隐藏终端

在一个目的主机的范围内有多个发送主机，这些发送主机不一定能够检测到其他主机，则存在隐藏终端。要解决这个问题，【预约】的方式来避免碰撞。

站点之间使用 RTS（请求发送）帧和 CTS（允许发送）帧来预约对信道的访问。

发送站点在侦听到信道空闲，等待一个 DIFS 后发送一个 RTS 控制帧，指示传输 DATA 帧和 ACK 需要的时间。目的站点接收到 RTS 帧后，广播一个 CTS 帧作为响应。其他站点在接收到这个 CTS 帧后，在 CTS 帧指明的时间内抑制发送。

# Relative

---

[数据链路层](数据链路层.md)

# Reference

---
