---
aliases: []
tags:
  - 数据结构
date created: 2023-09-07 四 07:54:22
date modified: 2023-09-08 五 10:59:38
---

# Link

---

Previous: [数组](数组.md)

Next: [树](树.md)

# 串

---

## KMP 算法

^a7c517

### PMT

PMT (Partial March Table)，部分匹配表。

通过模式串的真前缀和真尾缀相互匹配得出。用真前缀的前缀部分和真尾缀的尾缀部分进行匹配。

对于模式串 $abaabc$，可以得到如下 PMT：

| a   | b   | a   | a   | b   | c   |
| --- | --- | --- | --- | --- | --- |
| 0   | 0   | 1   | 1   | 2   | 0   |

- 过程如下：
  - 子串为：$a$
    - 没有真前缀与真尾缀
    - PMT = 0
  - 子串为：$ab$
    - 最长真前缀：a
    - 最长真尾缀：b
    - 匹配部分：$\emptyset$
    - PMT = 0
  - 子串为：$aba$
    - 最长真前缀：$\underline{a}b$
    - 最长真尾缀：$b\underline{a}$
    - 匹配部分：$b$
    - PMT = 1
  - 子串为：$abaa$
    - 最长真前缀：$\underline{a}ba$
    - 最长真尾缀：$ba\underline{a}$
    - 匹配部分：$a$
    - PMT = 1
  - 子串为：$abaab$
    - 最长真前缀：$\underline{ab}aa$
    - 最长真尾缀：$ba\underline{ab}$
    - 匹配部分：$ab$
    - PMT = 2
  - 子串为：$abaabc$
    - 最长真前缀：$abaab$
    - 最长真尾缀：$baabc$
    - 匹配部分：$\emptyset$
    - PMT = 0

综上，得到了 PMT。

PMT 用于出现匹配串和模式串无法匹配时，指示模式串指针 $j$ 应跳转的位置。

### 匹配过程

一个简单的例子介绍一下 PMT 在匹配过程中的作用

匹配串：$abaabaabcabaabc$，匹配串指针 $i$
模式串：$abaabc$，模式串指针 $j$
PMT：

| 0     | 1     | 2     | 3     | 4     | 5     |
| ----- | ----- | ----- | ----- | ----- | ----- |
| a     | b     | a     | a     | b     | c     |
| **0** | **0** | **1** | **1** | **2** | **0** |

| 0     | 1     | 2     | 3     | 4     | 5               | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  |
| ----- | ----- | ----- | ----- | ----- | --------------- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| a     | b     | a     | a     | b     | $\underline{a}$ | a   | b   | c   | a   | b   | a   | a   | b   | c   |
| a     | b     | a     | a     | b     | $\underline{c}$ |     |     |     |     |     |     |     |     |     |
| **0** | **1** | **2** | **3** | **4** | **5**           |     |     |     |     |     |     |     |     |     |

$i=5,j=5$ 时出现失配，令 $j=pmt[j-1]=2$，模式串跳转到如下状态

| 0   | 1   | 2   | 3     | 4     | 5               | 6     | 7     | 8     | 9   | 10  | 11  | 12  | 13  | 14  |
| --- | --- | --- | ----- | ----- | --------------- | ----- | ----- | ----- | --- | --- | --- | --- | --- | --- |
| a   | b   | a   | a     | b     | $\underline{a}$ | a     | b     | c     | a   | b   | a   | a   | b   | c   |
|     |     |     | a     | b     | $\underline{a}$ | a     | b     | c     |     |     |     |     |     |     |
|     |     |     | **0** | **1** | **2**           | **3** | **4** | **5** |     |     |     |     |     |     |

继续匹配，发现匹配完成。

- 跳转后说明 $[0, j-1]$ 部分的字符匹配成功，接下来需要匹配 $j$ 位置处的字符，若不超过需要继续回退 $j=pmt[j-1]$。
- 模式串指针 $j$ 跳转到 0 时仍未匹配成功，则匹配串指针 $i$ 前进 1 位。

### next（考研主要考察的方法）

将 PMT 右移一位，再将 PMT[0]置 -1。

此时失配的跳转顺序为：$j\rightarrow next[j] \rightarrow next[next[j]]\rightarrow ...$。

匹配串：$abaabaabcabaabc$，匹配串指针 $i$
模式串：$abaabc$，模式串指针 $j$
next：

| 0   | 1   | 2   | 3   | 4   | 5   |
| --- | --- | --- | --- | --- | --- |
| a   | b   | a   | a   | b   | c   |
| -1  | 0   | 0   | 1   | 1   | 2   |

| 0     | 1     | 2     | 3     | 4     | 5               | 6   | 7   | 8   | 9   | 10  | 11  | 12  | 13  | 14  |
| ----- | ----- | ----- | ----- | ----- | --------------- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| a     | b     | a     | a     | b     | $\underline{a}$ | a   | b   | c   | a   | b   | a   | a   | b   | c   |
| a     | b     | a     | a     | b     | $\underline{c}$ |     |     |     |     |     |     |     |     |     |
| **0** | **1** | **2** | **3** | **4** | **5**           |     |     |     |     |     |     |     |     |     |

$i=5,j=5$ 时出现失配，令 $j=next[j]=2$，模式串跳转到如下状态

| 0   | 1   | 2   | 3     | 4     | 5               | 6     | 7     | 8     | 9   | 10  | 11  | 12  | 13  | 14  |
| --- | --- | --- | ----- | ----- | --------------- | ----- | ----- | ----- | --- | --- | --- | --- | --- | --- |
| a   | b   | a   | a     | b     | $\underline{a}$ | a     | b     | c     | a   | b   | a   | a   | b   | c   |
|     |     |     | a     | b     | $\underline{a}$ | a     | b     | c     |     |     |     |     |     |     |
|     |     |     | **0** | **1** | **2**           | **3** | **4** | **5** |     |     |     |     |     |     |

继续匹配，发现匹配完成。

# Relative

---

[数据结构思维导图](数据结构思维导图.md)

# Reference

---

[算法学习笔记(13): KMP 算法 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/105629613)
