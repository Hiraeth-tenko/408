---
aliases:
tags:
  - 操作系统
date created: 2023-09-27 三 04:15:05
date modified: 2023-10-23 一 12:48:35
---

# Link

---

Previous: [4.3.2\_基本分页存储管理](4.3.2_基本分页存储管理.md)

Next: [4.4\_段式存储管理](4.4_段式存储管理.md)

# 请求分页存储管理

---

## 请求分页存储管理

请求分页存储管理在[4.3.2\_基本分页存储管理](4.3.2_基本分页存储管理.md)的基础之上，增加了一些控制位以实现新的功能。

### 页表项

单级页表划分的地址结构：

| 页号 P | 页内偏移量 W |
| ------ | ------------ |

单级页表对应的页表项：

| 页号 P | 块号 (页框号) B | 存在位 | 访问位 | 修改位 |
| ------ | --------------- | ------ | ------ | ------ |

具体的页表项由题目给出。

$实际地址EA=页目录的始址BA+页框号B\times 页框大小L+页内偏移量W$。

如何理解：实际地址 $EA$ 就是在某个页框中的某个位置，由页框号 $B$ 定位到该页框的始址 ($BA+B\times L$)，再加上页内偏移量 $W$ 得到 $EA$。

### 页框分配

|                  | 固定分配局部置换                                           | 可变分配局部置换                                 | 可变分配全局置换                               |
| ---------------- | ---------------------------------------------------------- | ------------------------------------------------ | ---------------------------------------------- |
| 物理块数         | 固定不变                                                   | 适当增减                                         | 适当增减                                       |
| 缺页时的调页策略 | 总内存大小不变，将该进程处于内存中的页调出，再调入需要的页 | 从全局的空闲物理块队列中给该增加物理块并调入缺页 | 发生缺页时，调换内存的页；频繁缺页时增加物理块 |

## 页面置换算法

### 最佳置换 (OPT)

选择不再访问，或将未来最长时间不访问的页面替换出，得到最小的缺页率。

### 先进先出 (FIFO)

Belady：分配物理块数增加而页故障次数不减反增。
同 Cache 部分。

### 最近最少使用 (LRU)

根据局部性原理，每次选择最近最少使用的页替换。
该算法为每一个页设置一个计数器，计数器按如下规则变化：

1. 命中时，比命中行计数器低的其余行计数器加一，命中行计数器清零，其余行不变。
2. 未命中且有空闲行时，其余行计数器加一，置入的新行计数器置零。
3. 未命中且无空闲行时，计数器最高的行被替换为新行，置入的新行计数器置零，其余行计数器加一。

### 时钟 (CLOCK)

又称最近未用 (NRU)。
为每页设置一个访问位 $A$，将内存中所有页面看作一个循环队列。选择要替换的页面时，检查访问位：1)、访问位为 1，置 0；2)、访问位为 0，替换出；由于是循环队列，遍历一遍没有访问位为 0 的页面，遍重新遍历。页面置入时访问位置 1。

### 改进时钟

增加了一个修改位 $M$。
访问位 $A$ 和修改位 $M$ 构成 4 种情况：

- $00$：未访问未修改，最佳淘汰页；
- $01$：未访问已修改，次级淘汰页；
- $10$：已访问未修改，次次级淘汰页；
- $11$：已访问已修改，最次淘汰页；
  进行多轮遍历：
- 第一轮，寻找 $AM=00$ 的页面，将第一个遭遇的页面淘汰；
- 第二轮，寻找 $AM=01$ 的页面，将第一个遭遇的页面淘汰，同时将访问位置 0；
- 第三轮，寻找 $AM=01$ 的页面，将第一个遭遇的页面淘汰；
- 每一轮淘汰了页面就不再继续后续扫描。

# Relative

---

[0\_操作系统思维导图](0_操作系统思维导图.md)

[存储系统相关](存储系统相关.md)

# Reference

---
